-- Raw data to give to Excel to generate the pivot table
-- TODO: currently the generator only creates the case-when clauses and not
-- the entire thing. Change this so that it totally generated
SELECT
  CASE
    WHEN p.score BETWEEN 1 AND 10 THEN 'Group 01: 1 - 10'
    WHEN p.score BETWEEN 11 AND 20 THEN 'Group 02: 11 - 20'
    WHEN p.score BETWEEN 21 AND 30 THEN 'Group 03: 21 - 30'
    WHEN p.score BETWEEN 31 AND 40 THEN 'Group 04: 31 - 40'
    WHEN p.score BETWEEN 41 AND 50 THEN 'Group 05: 41 - 50'
    WHEN p.score BETWEEN 51 AND 60 THEN 'Group 06: 51 - 60'
    WHEN p.score BETWEEN 61 AND 70 THEN 'Group 07: 61 - 70'
    WHEN p.score BETWEEN 71 AND 80 THEN 'Group 08: 71 - 80'
    WHEN p.score BETWEEN 81 AND 90 THEN 'Group 09: 81 - 90'
    WHEN p.score BETWEEN 91 AND 100 THEN 'Group 10: 91 - 100'
    WHEN p.score BETWEEN 101 AND 110 THEN 'Group 11: 101 - 110'
    WHEN p.score BETWEEN 111 AND 120 THEN 'Group 12: 111 - 120'
    WHEN p.score BETWEEN 121 AND 130 THEN 'Group 13: 121 - 130'
    WHEN p.score BETWEEN 131 AND 140 THEN 'Group 14: 131 - 140'
    WHEN p.score BETWEEN 141 AND 150 THEN 'Group 15: 141 - 150'
    WHEN p.score BETWEEN 151 AND 160 THEN 'Group 16: 151 - 160'
    WHEN p.score BETWEEN 161 AND 170 THEN 'Group 17: 161 - 170'
    WHEN p.score BETWEEN 171 AND 180 THEN 'Group 18: 171 - 180'
    WHEN p.score BETWEEN 181 AND 190 THEN 'Group 19: 181 - 190'
    WHEN p.score BETWEEN 191 AND 200 THEN 'Group 20: 191 - 200'
    WHEN p.score BETWEEN 201 AND 210 THEN 'Group 21: 201 - 210'
    WHEN p.score BETWEEN 211 AND 220 THEN 'Group 22: 211 - 220'
    WHEN p.score BETWEEN 221 AND 230 THEN 'Group 23: 221 - 230'
    WHEN p.score BETWEEN 231 AND 240 THEN 'Group 24: 231 - 240'
    WHEN p.score BETWEEN 241 AND 250 THEN 'Group 25: 241 - 250'
    WHEN p.score BETWEEN 251 AND 260 THEN 'Group 26: 251 - 260'
    WHEN p.score BETWEEN 261 AND 270 THEN 'Group 27: 261 - 270'
    WHEN p.score BETWEEN 271 AND 280 THEN 'Group 28: 271 - 280'
    WHEN p.score BETWEEN 281 AND 290 THEN 'Group 29: 281 - 290'
    WHEN p.score BETWEEN 291 AND 300 THEN 'Group 30: 291 - 300'
    ELSE 'Group 31: n > 300' END AS score_group,
  CASE
    WHEN CHAR_LENGTH(p.content_text) BETWEEN 1 AND 50 THEN 'Group 01: 1 - 50'
    WHEN CHAR_LENGTH(p.content_text) BETWEEN 51 AND 100 THEN 'Group 02: 51 - 100'
    WHEN CHAR_LENGTH(p.content_text) BETWEEN 101 AND 150 THEN 'Group 03: 101 - 150'
    WHEN CHAR_LENGTH(p.content_text) BETWEEN 151 AND 200 THEN 'Group 04: 151 - 200'
    WHEN CHAR_LENGTH(p.content_text) BETWEEN 201 AND 250 THEN 'Group 05: 201 - 250'
    WHEN CHAR_LENGTH(p.content_text) BETWEEN 251 AND 300 THEN 'Group 06: 251 - 300'
    WHEN CHAR_LENGTH(p.content_text) BETWEEN 301 AND 350 THEN 'Group 07: 301 - 350'
    WHEN CHAR_LENGTH(p.content_text) BETWEEN 351 AND 400 THEN 'Group 08: 351 - 400'
    WHEN CHAR_LENGTH(p.content_text) BETWEEN 401 AND 450 THEN 'Group 09: 401 - 450'
    WHEN CHAR_LENGTH(p.content_text) BETWEEN 451 AND 500 THEN 'Group 10: 451 - 500'
    WHEN CHAR_LENGTH(p.content_text) BETWEEN 501 AND 550 THEN 'Group 11: 501 - 550'
    WHEN CHAR_LENGTH(p.content_text) BETWEEN 551 AND 600 THEN 'Group 12: 551 - 600'
    WHEN CHAR_LENGTH(p.content_text) BETWEEN 601 AND 650 THEN 'Group 13: 601 - 650'
    WHEN CHAR_LENGTH(p.content_text) BETWEEN 651 AND 700 THEN 'Group 14: 651 - 700'
    WHEN CHAR_LENGTH(p.content_text) BETWEEN 701 AND 750 THEN 'Group 15: 701 - 750'
    WHEN CHAR_LENGTH(p.content_text) BETWEEN 751 AND 800 THEN 'Group 16: 751 - 800'
    WHEN CHAR_LENGTH(p.content_text) BETWEEN 801 AND 850 THEN 'Group 17: 801 - 850'
    WHEN CHAR_LENGTH(p.content_text) BETWEEN 851 AND 900 THEN 'Group 18: 851 - 900'
    WHEN CHAR_LENGTH(p.content_text) BETWEEN 901 AND 950 THEN 'Group 19: 901 - 950'
    WHEN CHAR_LENGTH(p.content_text) BETWEEN 951 AND 1000 THEN 'Group 20: 951 - 1000'
    WHEN CHAR_LENGTH(p.content_text) BETWEEN 1001 AND 1050 THEN 'Group 21: 1001 - 1050'
    WHEN CHAR_LENGTH(p.content_text) BETWEEN 1051 AND 1100 THEN 'Group 22: 1051 - 1100'
    WHEN CHAR_LENGTH(p.content_text) BETWEEN 1101 AND 1150 THEN 'Group 23: 1101 - 1150'
    WHEN CHAR_LENGTH(p.content_text) BETWEEN 1151 AND 1200 THEN 'Group 24: 1151 - 1200'
    WHEN CHAR_LENGTH(p.content_text) BETWEEN 1201 AND 1250 THEN 'Group 25: 1201 - 1250'
    WHEN CHAR_LENGTH(p.content_text) BETWEEN 1251 AND 1300 THEN 'Group 26: 1251 - 1300'
    WHEN CHAR_LENGTH(p.content_text) BETWEEN 1301 AND 1350 THEN 'Group 27: 1301 - 1350'
    WHEN CHAR_LENGTH(p.content_text) BETWEEN 1351 AND 1400 THEN 'Group 28: 1351 - 1400'
    WHEN CHAR_LENGTH(p.content_text) BETWEEN 1401 AND 1450 THEN 'Group 29: 1401 - 1450'
    WHEN CHAR_LENGTH(p.content_text) BETWEEN 1451 AND 1500 THEN 'Group 30: 1451 - 1500'
    WHEN CHAR_LENGTH(p.content_text) BETWEEN 1501 AND 1550 THEN 'Group 31: 1501 - 1550'
    WHEN CHAR_LENGTH(p.content_text) BETWEEN 1551 AND 1600 THEN 'Group 32: 1551 - 1600'
    WHEN CHAR_LENGTH(p.content_text) BETWEEN 1601 AND 1650 THEN 'Group 33: 1601 - 1650'
    WHEN CHAR_LENGTH(p.content_text) BETWEEN 1651 AND 1700 THEN 'Group 34: 1651 - 1700'
    WHEN CHAR_LENGTH(p.content_text) BETWEEN 1701 AND 1750 THEN 'Group 35: 1701 - 1750'
    WHEN CHAR_LENGTH(p.content_text) BETWEEN 1751 AND 1800 THEN 'Group 36: 1751 - 1800'
    WHEN CHAR_LENGTH(p.content_text) BETWEEN 1801 AND 1850 THEN 'Group 37: 1801 - 1850'
    WHEN CHAR_LENGTH(p.content_text) BETWEEN 1851 AND 1900 THEN 'Group 38: 1851 - 1900'
    WHEN CHAR_LENGTH(p.content_text) BETWEEN 1901 AND 1950 THEN 'Group 39: 1901 - 1950'
    WHEN CHAR_LENGTH(p.content_text) BETWEEN 1951 AND 2000 THEN 'Group 40: 1951 - 2000'
    WHEN CHAR_LENGTH(p.content_text) BETWEEN 2001 AND 2050 THEN 'Group 41: 2001 - 2050'
    WHEN CHAR_LENGTH(p.content_text) BETWEEN 2051 AND 2100 THEN 'Group 42: 2051 - 2100'
    WHEN CHAR_LENGTH(p.content_text) BETWEEN 2101 AND 2150 THEN 'Group 43: 2101 - 2150'
    WHEN CHAR_LENGTH(p.content_text) BETWEEN 2151 AND 2200 THEN 'Group 44: 2151 - 2200'
    WHEN CHAR_LENGTH(p.content_text) BETWEEN 2201 AND 2250 THEN 'Group 45: 2201 - 2250'
    WHEN CHAR_LENGTH(p.content_text) BETWEEN 2251 AND 2300 THEN 'Group 46: 2251 - 2300'
    WHEN CHAR_LENGTH(p.content_text) BETWEEN 2301 AND 2350 THEN 'Group 47: 2301 - 2350'
    WHEN CHAR_LENGTH(p.content_text) BETWEEN 2351 AND 2400 THEN 'Group 48: 2351 - 2400'
    WHEN CHAR_LENGTH(p.content_text) BETWEEN 2401 AND 2450 THEN 'Group 49: 2401 - 2450'
    WHEN CHAR_LENGTH(p.content_text) BETWEEN 2451 AND 2500 THEN 'Group 50: 2451 - 2500'
    WHEN CHAR_LENGTH(p.content_text) BETWEEN 2501 AND 2550 THEN 'Group 51: 2501 - 2550'
    WHEN CHAR_LENGTH(p.content_text) BETWEEN 2551 AND 2600 THEN 'Group 52: 2551 - 2600'
    WHEN CHAR_LENGTH(p.content_text) BETWEEN 2601 AND 2650 THEN 'Group 53: 2601 - 2650'
    WHEN CHAR_LENGTH(p.content_text) BETWEEN 2651 AND 2700 THEN 'Group 54: 2651 - 2700'
    WHEN CHAR_LENGTH(p.content_text) BETWEEN 2701 AND 2750 THEN 'Group 55: 2701 - 2750'
    WHEN CHAR_LENGTH(p.content_text) BETWEEN 2751 AND 2800 THEN 'Group 56: 2751 - 2800'
    WHEN CHAR_LENGTH(p.content_text) BETWEEN 2801 AND 2850 THEN 'Group 57: 2801 - 2850'
    WHEN CHAR_LENGTH(p.content_text) BETWEEN 2851 AND 2900 THEN 'Group 58: 2851 - 2900'
    WHEN CHAR_LENGTH(p.content_text) BETWEEN 2901 AND 2950 THEN 'Group 59: 2901 - 2950'
    WHEN CHAR_LENGTH(p.content_text) BETWEEN 2951 AND 3000 THEN 'Group 60: 2951 - 3000'
    WHEN CHAR_LENGTH(p.content_text) BETWEEN 3001 AND 3050 THEN 'Group 61: 3001 - 3050'
    WHEN CHAR_LENGTH(p.content_text) BETWEEN 3051 AND 3100 THEN 'Group 62: 3051 - 3100'
    WHEN CHAR_LENGTH(p.content_text) BETWEEN 3101 AND 3150 THEN 'Group 63: 3101 - 3150'
    WHEN CHAR_LENGTH(p.content_text) BETWEEN 3151 AND 3200 THEN 'Group 64: 3151 - 3200'
    WHEN CHAR_LENGTH(p.content_text) BETWEEN 3201 AND 3250 THEN 'Group 65: 3201 - 3250'
    WHEN CHAR_LENGTH(p.content_text) BETWEEN 3251 AND 3300 THEN 'Group 66: 3251 - 3300'
    WHEN CHAR_LENGTH(p.content_text) BETWEEN 3301 AND 3350 THEN 'Group 67: 3301 - 3350'
    WHEN CHAR_LENGTH(p.content_text) BETWEEN 3351 AND 3400 THEN 'Group 68: 3351 - 3400'
    WHEN CHAR_LENGTH(p.content_text) BETWEEN 3401 AND 3450 THEN 'Group 69: 3401 - 3450'
    WHEN CHAR_LENGTH(p.content_text) BETWEEN 3451 AND 3500 THEN 'Group 70: 3451 - 3500'
    WHEN CHAR_LENGTH(p.content_text) BETWEEN 3501 AND 3550 THEN 'Group 71: 3501 - 3550'
    WHEN CHAR_LENGTH(p.content_text) BETWEEN 3551 AND 3600 THEN 'Group 72: 3551 - 3600'
    WHEN CHAR_LENGTH(p.content_text) BETWEEN 3601 AND 3650 THEN 'Group 73: 3601 - 3650'
    WHEN CHAR_LENGTH(p.content_text) BETWEEN 3651 AND 3700 THEN 'Group 74: 3651 - 3700'
    WHEN CHAR_LENGTH(p.content_text) BETWEEN 3701 AND 3750 THEN 'Group 75: 3701 - 3750'
    WHEN CHAR_LENGTH(p.content_text) BETWEEN 3751 AND 3800 THEN 'Group 76: 3751 - 3800'
    WHEN CHAR_LENGTH(p.content_text) BETWEEN 3801 AND 3850 THEN 'Group 77: 3801 - 3850'
    WHEN CHAR_LENGTH(p.content_text) BETWEEN 3851 AND 3900 THEN 'Group 78: 3851 - 3900'
    WHEN CHAR_LENGTH(p.content_text) BETWEEN 3901 AND 3950 THEN 'Group 79: 3901 - 3950'
    WHEN CHAR_LENGTH(p.content_text) BETWEEN 3951 AND 4000 THEN 'Group 80: 3951 - 4000'
    WHEN CHAR_LENGTH(p.content_text) BETWEEN 4001 AND 4050 THEN 'Group 81: 4001 - 4050'
    WHEN CHAR_LENGTH(p.content_text) BETWEEN 4051 AND 4100 THEN 'Group 82: 4051 - 4100'
    WHEN CHAR_LENGTH(p.content_text) BETWEEN 4101 AND 4150 THEN 'Group 83: 4101 - 4150'
    WHEN CHAR_LENGTH(p.content_text) BETWEEN 4151 AND 4200 THEN 'Group 84: 4151 - 4200'
    WHEN CHAR_LENGTH(p.content_text) BETWEEN 4201 AND 4250 THEN 'Group 85: 4201 - 4250'
    WHEN CHAR_LENGTH(p.content_text) BETWEEN 4251 AND 4300 THEN 'Group 86: 4251 - 4300'
    WHEN CHAR_LENGTH(p.content_text) BETWEEN 4301 AND 4350 THEN 'Group 87: 4301 - 4350'
    WHEN CHAR_LENGTH(p.content_text) BETWEEN 4351 AND 4400 THEN 'Group 88: 4351 - 4400'
    WHEN CHAR_LENGTH(p.content_text) BETWEEN 4401 AND 4450 THEN 'Group 89: 4401 - 4450'
    WHEN CHAR_LENGTH(p.content_text) BETWEEN 4451 AND 4500 THEN 'Group 90: 4451 - 4500'
    WHEN CHAR_LENGTH(p.content_text) BETWEEN 4501 AND 4550 THEN 'Group 91: 4501 - 4550'
    WHEN CHAR_LENGTH(p.content_text) BETWEEN 4551 AND 4600 THEN 'Group 92: 4551 - 4600'
    WHEN CHAR_LENGTH(p.content_text) BETWEEN 4601 AND 4650 THEN 'Group 93: 4601 - 4650'
    WHEN CHAR_LENGTH(p.content_text) BETWEEN 4651 AND 4700 THEN 'Group 94: 4651 - 4700'
    WHEN CHAR_LENGTH(p.content_text) BETWEEN 4701 AND 4750 THEN 'Group 95: 4701 - 4750'
    WHEN CHAR_LENGTH(p.content_text) BETWEEN 4751 AND 4800 THEN 'Group 96: 4751 - 4800'
    WHEN CHAR_LENGTH(p.content_text) BETWEEN 4801 AND 4850 THEN 'Group 97: 4801 - 4850'
    WHEN CHAR_LENGTH(p.content_text) BETWEEN 4851 AND 4900 THEN 'Group 98: 4851 - 4900'
    ELSE 'Group 99: n > 4900' END AS length_group,
  _id AS ID,
  CHAR_LENGTH(p.content_text) AS text_length,
  p.score as score
FROM posts p
INTO OUTFILE '/var/lib/mysql-files/pivot.csv'
FIELDS TERMINATED BY ','
OPTIONALLY ENCLOSED BY '"'
ESCAPED BY '"'
LINES TERMINATED BY '\n'
